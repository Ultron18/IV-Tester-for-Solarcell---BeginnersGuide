# Beginners Guide IV Tester Repository

This repository contains tools and scripts for simulating and analyzing Finite Element Models (FEM) of solar cells using SPICE simulations. It includes resistance generation, netlist/subcircuit creation, LTSpice integration, and result parsing for automated analysis.

I personally recommend to have a look at the `resistance_eval` before start understanding/using other directorires. This code normalize per unit length reistances in mesh network into resistances per node in the network. currently there are 9x120 nodes for 9 busbars and 120 fingers. Having multiple nodes will yield better results (Not needed acatually, ig).

There are 2 directories in this repo for the purposes provided below:
- `FEM_for_SolarCellSetup`: is used for obtaining IV characteristics and comparing different configurations of solarcell (in FIMV and FVMI measurement methods).
- `IterativeCodeForGoldChuck`: is used to find an estimate of gold chuck's mesh network resistances by using an iterative routine with ltspice.

See the Example workflow sub-heading in each directory to see how to quick work with it.

# ğŸ“ Repository Structure

```bash
Beginners_Guide_IV_tester_Repo/
â”œâ”€â”€ FEM_for_SolarCellSetup/       # Main simulation and config generation workflow
â”œâ”€â”€ IterativeCodeForGoldChuck/    # Scripts for iterative simulations (TBD)
â”œâ”€â”€ SPICE_to_ref/                 # SPICE helper files (TBD)
â””â”€â”€ resistance_eval.ipynb         # Notebook for evaluating resistance methods
```

# ğŸ“ FEM_for_SolarCellSetup - How It Works

This is the core folder where the FEM model of the solar cell is developed and simulated.

---

## 1. ğŸ§® Generate FEM and Contact Parameters

**File:**

- `parameter_gen_script.ipynb`

**Generates:**

- FEM grid resistances (intracell resistances)
- Pogo pin contact resistances per probe

> Output is used to define the electrical model of the solar cell

---

## 2. ğŸ§¾ Create Netlist and Subcircuit

**Files:**

- `solarcell_config_00.ipynb`
- `solarcell_config_01.ipynb`
- `solarcell_config_10.ipynb`
- `solarcell_config_11.ipynb`
- `solarConfig_I.ipynb`
- `solarConfig_NI.ipynb`

**These scripts:**

- Create `.net` (netlist) and `.sub` (subcircuit) files for different solar cell configurations
- Each config file corresponds to a specific FEM layout and contact map

> âš ï¸ Make sure to update paths:
>
> - `ltspice.exe` path  
> - `Model/sim1` output folder path  
> - `.lib` footer path for SPICE compatibility

---

## 3. ğŸ§° Model Folder and LTSpice Simulation

**Directory Structure:**

```
Model/sim1/
â”œâ”€â”€ config1/
â”‚   â”œâ”€â”€ SolarCell.net
â”‚   â”œâ”€â”€ SolarCell.sub
â”‚   â”œâ”€â”€ FVMI.asc
â”‚   â”œâ”€â”€ FIMV.asc
â”‚   â””â”€â”€ *.raw   <- to be generated by LTSpice
â”œâ”€â”€ config2/
â”‚   â””â”€â”€ ...
```

After running a config file, a new folder will be created under `Model/sim1/`.

Each folder will contain:

- `.net` and `.sub` files  
- `FVMI.asc` and `FIMV.asc` â€” measurement schematics (Voltage/Current controlled modes)  
- `.raw` files â€” generated after you run the simulation in LTSpice  

> âš ï¸ Ensure `.asy` symbol file is added if creating a new configuration  
> âš ï¸ You must **manually run LTSpice** simulations to generate `.raw` files

---

## 4. ğŸ“Š Parse Results and Plot

**File:**

- `results_for_comparision.ipynb`

**Features:**

- Scans all folders in `Model/sim1`
- Parses `.raw` files to extract:
  - Time-evolving voltages at each node
  - Currents through each element
- Generates plots for comparison across configurations

---

## ğŸ§  Notes & Tips

- Always double-check the paths before running any notebook
- For new configurations:
  - Copy `.asy`, `FVMI.asc`, `FIMV.asc` into the new config folder
  - Reconnect measurement circuit in LTSpice if required
- Use **LTSpice in Windows** for best compatibility with file paths and simulation speed

---

## ğŸ“ˆ Example Workflow

```
1. Run parameter_gen_script.ipynb
2. Run solarcell_config_10.ipynb â†’ creates files in Model/sim1/config_10/
3. Open LTSpice â†’ run FVMI.asc â†’ generates SolarCell.raw
4. Run results_for_comparision.ipynb â†’ view and compare plots
```

NOTE: In step 2, the folder `config_xx` will be created in the name provided as a path in the `solarcell_config.ipynb` file. Name any new config that you are creating in this format only (eg). the folder name is `config<AnyName>`

---
---






# ğŸ“ IterativeCodeForGoldChuck

This directory contains experiments and optimization routines related to modeling the gold chuck used in solar cell probing. It is split into two stages:

```
IterativeCodeForGoldChuck/
â”œâ”€â”€ Gold_Mk0/   # Parallel resistor model
â””â”€â”€ Gold_Mk1/   # Mesh network model of chuck
```

---

## ğŸŸ¡ Gold_Mk0 â€” Parallel Network Optimization

**File:**

- `OptimizeParameter.ipynb`

**Purpose:**

- Determines the base resistance `R` for a parallel network of resistors: `R`, `2R`, and `3R`
- Uses LTSpice simulations to match the equivalent resistance to a user-specified target

**Method:**

- Runs an optimization loop to iteratively adjust `R`
- Simulates the parallel netlist using LTSpice
- Compares the resulting equivalent resistance with the target

**Supporting Files:**

- `spice_model.net` â€” Netlist of the parallel resistor network  
- `spice_model.raw`, `.op.raw`, `.log` â€” Generated from LTSpice  

âœ… **Status**: Verified working and accurate

---

## ğŸŸ¡ Gold_Mk1 â€” Golden Chuck Mesh Network Modeling

**Files:**

- `OptimizeParameter.ipynb`  
- `spice_model.net`  

**Purpose:**

- Models the gold chuck as a **mesh of resistors**
- Given a physical side-to-side resistance of the chuck, this setup finds the **infinitesimal mesh resistance**

**Method:**

- Uses geometry-based resistance formula: `R = Ïl/A`
- Creates a mesh-style resistor network in SPICE
- Helps extract internal resistance characteristics via simulation

> ğŸ“Œ Currently in development. Make sure netlist structure matches actual physical chuck layout.  
> Future plans include symbolic mesh generation based on chuck dimensions.

---

## ğŸ§ª LTSpice Simulation Notes

- Use `.net` with LTSpice to simulate resistor networks
- Raw outputs (`.raw`, `.op.raw`) are parsed in notebooks
- Ensure `ltspice.exe` path is configured correctly in your system

---

## ğŸ“ˆ Example Workflow for Optimization

```
1. Edit target resistance in OptimizeParameter.ipynb (Gold_Mk0)
2. Run notebook to auto-simulate and compute optimal R
3. Observe convergence and verify with spice_model.raw

OR

1. Model mesh netlist manually in Gold_Mk1
2. Simulate using LTSpice
3. Use test.ipynb to analyze results and compute infinitesimal R
```

---







*Created by Gokul*
